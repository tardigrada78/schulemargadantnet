<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Prüfungsfrage evaluieren</title>
  <link rel="stylesheet" href="style_black.css" />
</head>

<body>
  <a href="/index.html" target="_blank">Weitere KI-Tools (Startseite)</a>&nbsp;&nbsp;&nbsp;
  <a href="/feedback.html" target="_blank">Feedback geben</a>
  <h1>Prüfungsfrage evaluieren</h1>
  <p>
    Auf den Button klicken um die Prüfungsfrage zu klassifizieren und mit virtuellen Schüler*innen zu evaluieren. Die
    Frage kann auch auf Englisch (oder wohl in vielen anderen Sprachen) gestellt werden.
  </p>
  <h3>Prüfungsfrage</h3>
  <textarea id="formQuestion" rows="4"
    placeholder="Stelle hier die Frage...">Was geschieht, wenn einem Patienten aus Versehen eine Spritze mit normalem Leitungswasser verabreicht wird? Begründen Sie Ihre Antwort mit zellbiologischen Prozessen.</textarea>
  <h3>Lernziele</h3>
  <p>Optional: Falls vorhanden, hier Lernziele einfügen oder Stoffumfang beschreiben um der KI Kontext zu geben.</p>
  <textarea id="formContext" rows="4"
    placeholder="Stelle hier die Frage...">Erklären Sie, wie Diffusion funktioniert. Beschreiben Sie, wie Osmose den Wassergehalt einer Zelle beeinflusst und was das bedeutet. Erklären Sie die Begriffe hypotonisch, isotonisch, hypertonisch.</textarea>

  <div>
    <button id="buttonEval">Evaluiere die Prüfungsfrage</button>
    <div id="progressDiv"></div>
    <br />
    <div id="resultDiv"></div>
    <br />

    <script>

      // Wait for the DOM to load
      document.getElementById("buttonEval").addEventListener("click", async () => {
        try {
          const formText = document.getElementById("formQuestion").value.trim();
          const formContext = document.getElementById("formContext").value.trim();
          let textContext
          if (!formContext) {
            textContext = "";
          } else {
            textContext = "Berücksichtige bei deiner Antwort folgende Lernziele/Stoffumfang. Es ist das, was du gelernt hast:\n" + formContext + "\n";
          }
          document.getElementById("progressDiv").innerHTML =
            "<p>⚙️ Die Analyse der Prüfungsfrage läuft...</p>";
          document.getElementById("resultDiv").innerHTML = "";

          // Frage evaluieren
          let prompt =
            `Analysiere die folgende Prüfungsfrage nach den Kriterien von Bloom und Krathwohl. 
            Gib nur die Stufe zurück und eine ganz kurze und prägnante Begründung. Die Prüfungsfrage muss die Stufe erfüllen und nicht bloss Schlüsselwörter enthalten. 
            Die Kriterien sind wie folgt:
            Stufe; Kategorie; Beschreibung; Schlüsselwörter
            K1; erinnern; Fakten und grundlegende Konzepte abrufen.; definieren, vervielfältigen, auflisten, auswendig lernen, wiederholen, angeben
            K2; verstehen; Ideen oder Konzepte in eigenen Worten wiedergeben.; klassifizieren, beschreiben, diskutieren, erklären, identifizieren, lokalisieren, erkennen, berichten, auswählen, übersetzen
            K3; anwenden; Informationen in neuen Situationen nutzen.; ausführen, umsetzen, lösen, verwenden, demonstrieren, interpretieren, operieren, planen, skizzieren
            K4; analysieren; Verbindungen zwischen Ideen herstellen.; differenzieren, organisieren, in Beziehung setzen, vergleichen, kontrastieren, unterscheiden, untersuchen, experimentieren, fragen, testen
            K5; bewerten; Basierend auf den Lernmaterialien einen Standpunkt rechtfertigen.; einschätzen, argumentieren, verteidigen, beurteilen, auswählen, unterstützen, bewerten, kritisieren, abwägen
            K6; erschaffen; Eine neue oder originelle Arbeit entwickeln.; entwerfen, zusammenstellen, konstruieren, mutmaßen, entwickeln, formulieren, verfassen, untersuchen
            Frage: "${formText}"`;
          let response = await fetch("/testeval/getEval", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ question: prompt , temperature: 0.2 })
          });
          let data = await response.json();
          evalSentence = data.sentence;
          outputText = `<h3>Taxonomie nach Bloom und Krathwohl</h3><p>${evalSentence}</p>`;

          // Leistungsschwache Schüler*in antwortet
          prompt =
            `Du bist ein leistungsschwacher Schüler des Gymnasiums. Beantworte die folgende schriftliche Prüfungsfrage äusserst knapp, unpräzise, ohne Fachbegriffe, unvollständig und teilweise falsch. 
            Du hast den Stoff nicht im Griff und glaubst eher an Alltagsweisheiten sowie typische Fehlkonzepte. Deine Antwort auf die Frage ist mangelhaft. 
            ${textContext}
            Frage: "${formText}"`;
          console.log("Prompt leistungsschwache Schüler*in:", prompt);
          response = await fetch("/testeval/getEval", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ question: prompt, temperature: 0.4  })
          });
          data = await response.json();
          evalSentence = data.sentence;
          outputText += `<h3>Antwort einer leistungsschwachen Schüler*in</h3><p>${evalSentence}</p>`;

          // Leistungstarke Schüler*in antwortet
          prompt =
            `Du bist ein leistungsstarker und engagierter Schüler des Gymnasiums. Beantworte die folgende Prüfungsfrage sehr gut und prägnant,  
            zeige, dass du den Stoff sehr gut verstanden hast. Verwende Fachbegriffe realistisch der Gymnasiualstufe entsprechend.
            ${textContext}
            Frage: "${formText}"`;
          response = await fetch("/testeval/getEval", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ question: prompt, temperature: 0.4 })
          });
          data = await response.json();
          evalSentence = data.sentence;

          // Ausgabe
          outputText += `<h3>Antwort einer leistungsstarken Schüler*in</h3><p>${evalSentence}</p>`;
          document.getElementById("resultDiv").innerHTML = outputText;
          document.getElementById("progressDiv").innerHTML = "";
        } catch (error) {
          console.error("Error:", error);
        }
      });
    </script>
</body>

</html>